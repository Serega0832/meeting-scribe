{% extends "base.html" %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <header class="mb-8 flex items-center justify-between">
        <div>
            <h1 class="text-3xl font-bold text-slate-900">Meeting Scribe</h1>
            <p class="text-slate-500">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–∏–∫—Å–∞—Ü–∏—è –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–µ–π</p>
        </div>
        <div class="text-sm text-slate-400">Gemini Powered</div>
    </header>

    <!-- –ó–æ–Ω–∞ –æ—à–∏–±–æ–∫ -->
    <div id="error-container"></div>

    <!-- –§–û–†–ú–ê -->
    <form id="upload-form"
          hx-encoding="multipart/form-data"
          hx-post="/upload"
          hx-target="#meetings-list"
          hx-swap="afterbegin"
          hx-indicator="#spinner"
          hx-on::after-request="resetForm()">

        <!-- 1. –ó–û–ù–ê –ó–ê–ì–†–£–ó–ö–ò (–¢–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è) -->
        <div id="drop-zone" class="bg-white p-10 rounded-xl shadow-sm border-2 border-dashed border-slate-300 transition-all relative group cursor-pointer hover:border-blue-400 hover:bg-slate-50">

            <input type="file" id="file-input" name="file" class="hidden" accept="audio/*,video/*">

            <div class="flex flex-col items-center justify-center space-y-4 pointer-events-none">
                <!-- –ò–∫–æ–Ω–∫–∞ –º–µ–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                <div id="icon-container">
                    <svg class="w-16 h-16 text-slate-300 group-hover:text-blue-400 transition" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg>
                </div>

                <div class="text-center">
                    <p id="drop-text" class="text-slate-600 font-medium text-lg">–ù–∞–∂–º–∏—Ç–µ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞</p>
                    <p id="file-name" class="text-blue-600 font-bold text-xl mt-2 hidden"></p> <!-- –°—é–¥–∞ –≤—Å—Ç–∞–≤–∏—Ç—Å—è –∏–º—è —Ñ–∞–π–ª–∞ -->
                    <p class="text-xs text-slate-400 mt-2">MP3, WAV, M4A, MP4, MOV, MKV</p>
                </div>
            </div>

            <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ (—Å–ø–∏–Ω–Ω–µ—Ä) -->
            <div id="spinner" class="htmx-indicator absolute inset-0 bg-white/95 flex flex-col items-center justify-center rounded-xl z-20 backdrop-blur-sm">
                <div class="animate-spin rounded-full h-12 w-12 border-4 border-slate-200 border-t-blue-600 mb-4"></div>
                <p class="text-blue-600 font-bold text-lg animate-pulse">–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –∑–∞–ø–∏—Å—å...</p>
                <p class="text-slate-500 text-sm mt-2">–≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –æ—Ç 30 —Å–µ–∫—É–Ω–¥ –¥–æ –ø–∞—Ä—ã –º–∏–Ω—É—Ç</p>
            </div>
        </div>

        <!-- 2. –ö–ù–û–ü–ö–ê –î–ï–ô–°–¢–í–ò–Ø (–ü–æ—è–≤–ª—è–µ—Ç—Å—è –ü–û–î –∑–æ–Ω–æ–π) -->
        <!-- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä—ã—Ç–∞ (hidden) -->
        <div id="action-section" class="mt-6 text-center hidden transition-opacity duration-300">
            <button type="submit" id="submit-btn" class="bg-blue-600 text-white text-lg px-10 py-3 rounded-lg hover:bg-blue-700 font-bold shadow-lg hover:shadow-xl transform transition hover:-translate-y-0.5 active:translate-y-0">
                üöÄ –°–¥–µ–ª–∞—Ç—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—é
            </button>
            <p class="text-sm text-slate-400 mt-2">–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª –≤ Gemini</p>
        </div>

    </form>

    <!-- –°–ø–∏—Å–æ–∫ –≤—Å—Ç—Ä–µ—á -->
    <div class="mt-10 space-y-4" id="meetings-list">
        {% for meeting in meetings %}
            {% include 'components/meeting_row.html' %}
        {% endfor %}
    </div>
</div>

<script>
    // –ü—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–∞–π–ª–∞ –ø–æ –∫–ª–∏–∫—É –Ω–∞ –∑–æ–Ω—É
    document.getElementById('drop-zone').addEventListener('click', function() {
        document.getElementById('file-input').click();
    });

    // –§—É–Ω–∫—Ü–∏—è —Å–±—Ä–æ—Å–∞ —Ñ–æ—Ä–º—ã –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
    function resetForm() {
        document.getElementById('upload-form').reset();
        document.getElementById('action-section').classList.add('hidden');
        document.getElementById('file-name').classList.add('hidden');
        document.getElementById('drop-text').classList.remove('hidden');
        document.getElementById('file-name').textContent = "";
    }
</script>
{% endblock %}